%------------------------------------------------------------------------------------------
%
%
%   Project Name: NjustThesis Template for Bachelor of Economics , Management & Arts
%
%
%------------------------------------------------------------------------------------------
%
%                 created by Qingyun Fang <fqy2017@gmail.com>
%
%                        Last-modified: 2017-6-3
%
%------------------------------------------------------------------------------------------

\documentclass[cs4size,a4paper,fancyhdr,twoside]{ctexbook}


\usepackage{ulem}               %下划线强调
\usepackage{fancyhdr}           %页眉页脚
\usepackage{mathptmx}   %是英文字体为Times New Roman
\usepackage{amsmath}    %数学符号
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{bm}         %数学公式粗体
\usepackage{tabu}       %表格
\usepackage{booktabs}   %表格线宏包
\usepackage{tabularx}   %调整表格列宽
\usepackage{multirow}   %表格合并
\usepackage{array}      %数组宏包，用于表格宽度
\usepackage{multicol}   %表格合并
\usepackage{longtable}  %表格合并
\usepackage[figuresright]{rotating}   %表格合并
\usepackage[top=20mm, bottom=30mm, left=20mm, right=20mm]{geometry}  % 页面边距设置
\usepackage{graphicx}   %插图
\usepackage{amsmath}    %公式换行
\usepackage{titletoc}   %目录
\usepackage{listings}   %插入代码
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode} % 插入代码
\usepackage{textcomp}
\usepackage{texnames}   %TeX家族标识符
\usepackage[super,square,sort&compress]{natbib}   %参考文献设置
\usepackage{float}      %表格位置
\usepackage{setspace}   %调整行距
\usepackage{lastpage}   %得到论文页数
\usepackage{subfig}
\usepackage{color}
\usepackage{colortbl}
\usepackage{makecell}
\usepackage{titlesec}
\usepackage{times}
\usepackage[titletoc]{appendix}
\usepackage{caption}
%\usepackage{ccmap}      %很重要，不加包查重识别不了中文
\usepackage{url}        %插入网址
\usepackage{epstopdf}   %将eps格式转换成PDF


%-------------------------------------------------------------------------------
%	重新制定字体大小命令，以便后面方便使用
%-------------------------------------------------------------------------------

\newcommand{\chuhao}{\fontsize{45bp}{\baselineskip}\selectfont}
\newcommand{\xiaochu}{\fontsize{36pt}{\baselineskip}\selectfont}
\newcommand{\yihao}{\fontsize{28pt}{\baselineskip}\selectfont}
\newcommand{\erhao}{\fontsize{21pt}{\baselineskip}\selectfont}
\newcommand{\xiaoer}{\fontsize{18pt}{\baselineskip}\selectfont}
\newcommand{\sanhao}{\fontsize{15.75bp}{\baselineskip}\selectfont}
\newcommand{\xiaosan}{\fontsize{15pt}{\baselineskip}\selectfont}
\newcommand{\sihao}{\fontsize{14.05249pt}{\baselineskip}\selectfont}
\newcommand{\xiaosi}{\fontsize{12pt}{\baselineskip}\selectfont}
\newcommand{\wuhao}{\fontsize{10.5pt}{\baselineskip}\selectfont}
\newcommand{\xiaowu}{\fontsize{9pt}{\baselineskip}\selectfont}

\newcommand{\song}{\CJKfamily{song}}         % 宋体
\newcommand{\fs}{\CJKfamily{fs}}             % 仿宋体
\newcommand{\kai}{\CJKfamily{kai}}           % 楷体
\newcommand{\hei}{\CJKfamily{hei}}           % 黑体
\newcommand{\li}{\CJKfamily{li}}             % 隶书

%-------------------------------------------------------------------------------
%	重新制定章节标题样式，包括样式和标题与上下文的间距
%-------------------------------------------------------------------------------
\CTEXsetup[number={\arabic{chapter}}]{chapter}
\CTEXsetup[name={,}]{chapter}
\CTEXsetup[nameformat={\bf\heiti\zihao{-3}\raggedright}]{chapter}% 章标题格式
\CTEXsetup[titleformat={\bf\heiti\zihao{-3}\raggedright}]{chapter}% 章标题格式
\CTEXsetup[beforeskip={-3ex}]{chapter}
\CTEXsetup[afterskip={1ex}]{chapter}


\CTEXsetup[format={\heiti\zihao{4}\bf}]{section}
\CTEXsetup[format={\heiti\zihao{-4}}]{subsection}
\CTEXsetup[format={\heiti\zihao{-4}}]{subsubsection}

\titlespacing{\section}{0em}{0ex}{0ex}
\titlespacing{\subsection}{0em}{0ex}{0ex}
\titlespacing{\subsubsection}{0em}{0ex}{0ex}

%-------------------------------------------------------------------------------
%	制定页眉高度和页眉与正文的距离
%-------------------------------------------------------------------------------

\setlength{\headheight}{1.4cm}
\setlength{\headsep}{8pt}

%-------------------------------------------------------------------------------
%	制定页眉
%-------------------------------------------------------------------------------
\fancypagestyle{plain}{
  \pagestyle{fancy}      %改变章节首页页眉
}

\pagestyle{fancy}
\chead{\quad\\
\song\zihao{-2}\bfseries{
本\hspace{5mm}科\hspace{5mm}毕\hspace{5mm}业\hspace{5mm}论\hspace{5mm}文}}
\fancyhead[LE,RO]{第~\thepage ~页}
\fancyhead[RE,LO]{}
\cfoot{}

\renewcommand{\headrulewidth}{0.7pt}
\makeatletter
\newcommand{\openany}{\@openrightfalse}
\newcommand{\openright}{\@openrighttrue}
\makeatother
%-------------------------------------------------------------------------------
%	目录格式设置
%-------------------------------------------------------------------------------
\renewcommand{\contentsname}{\hspace*{\fill} 目\hspace{1.5em} 次\hspace*{\fill}}

\titlecontents{chapter}[0em]{\songti\zihao{-4}}{\thecontentslabel\ }{}
        {\hspace{.5em}\titlerule*[4pt]{$\cdot$}\contentspage}
\titlecontents{section}[0em]{\vspace{0.1\baselineskip}\songti\zihao{-4}}{\thecontentslabel\ }{}
        {\hspace{.5em}\titlerule*[4pt]{$\cdot$}\contentspage}
\titlecontents{subsection}[0em]{\vspace{0.1\baselineskip}\songti\zihao{-4}}{\thecontentslabel\ }{}
        {\hspace{.5em}\titlerule*[4pt]{$\cdot$}\contentspage}

%-------------------------------------------------------------------------------
%	参考文献标题设置
%-------------------------------------------------------------------------------

\renewcommand\bibname{参\hspace{0.5em}考\hspace{0.5em}文\hspace{0.5em}献}

%-------------------------------------------------------------------------------
%	附录标题设置
%-------------------------------------------------------------------------------

\CTEXsetup[name={附录},number={\Alph{chapter}}]{appendix}

%-------------------------------------------------------------------------------
%	图片标题设置
%-------------------------------------------------------------------------------

\captionsetup[table]{name={表},labelsep=quad}
\captionsetup[figure]{name={图},labelsep=quad}

\DeclareCaptionFont{captionfont}{\heiti\fontsize{10.5bp}{13.65bp}\selectfont}
\captionsetup{font=captionfont}

\newcommand{\topcaption}{%
\setlength{\abovecaptionskip}{0ex}%
\setlength{\belowcaptionskip}{1.5ex}%
\caption}   % 表格上标题修改


\setlength{\intextsep}{0pt}
\setlength{\textfloatsep} {0pt}

%-------------------------------------------------------------------------------
%	目录代码自动换行
%-------------------------------------------------------------------------------

\lstset{breaklines}%自动将长的代码行换行排版
\lstset{extendedchars=false}

%-------------------------------------------------------------------------------
%	 正文区
%-------------------------------------------------------------------------------
\begin{document}

 \include{ThesisCover}

 \include{ThesisStatement}
%
 \include{ThesisAbstract}
%
 \openright
 {\setlength{\baselineskip}{18bp}
  \pagenumbering{Roman}   %将目录页码转换为罗马数字
  \setcounter{page}{1}      %设置当前页为目录页第一页
  \CTEXsetup[nameformat={\heiti\zihao{-3}\raggedright}]{chapter}% 章标题格式
  \CTEXsetup[titleformat={\heiti\zihao{-3}\raggedright}]{chapter}% 章标题格式
  \CTEXsetup[beforeskip={8ex}]{chapter}
  \CTEXsetup[afterskip={6ex}]{chapter}
  \tableofcontents
  \cleardoublepage
 }                    %生成目录
%
\openany
\setlength{\extrarowheight}{2mm}

 \include{ChapterOne}
%
 \include{ChapterTwo}

 \include{ThesisConclusion}

 \include{ThesisThanks}

 \include{ThesisReference}

 \include{ThesisAppendix}

\end{document}
